% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mixedsimex.R
\name{mixedsimex}
\alias{mixedsimex}
\alias{print.mixedsimex}
\alias{summary.mixedsimex}
\alias{print.summary.mixedsimex}
\alias{plot.mixedsimex}
\alias{predict.mixedsimex}
\alias{refit.mixedsimex}
\title{Mixed SIMEX Method for Measurement Error and Misclassification}
\usage{
mixedsimex(
  model,
  SIMEXvariable,
  error.type,
  measurement.error = NULL,
  mc.matrix = NULL,
  lambda = c(0.5, 1, 1.5, 2),
  B = 100,
  fitting.method = "quadratic",
  jackknife.estimation = "quadratic",
  asymptotic = TRUE
)

\method{print}{mixedsimex}(x, digits = max(3, getOption("digits") - 3), ...)

\method{summary}{mixedsimex}(object, ...)

\method{print}{summary.mixedsimex}(x, digits = max(3, getOption("digits") - 3), ...)

\method{plot}{mixedsimex}(
  x,
  xlab = expression((1 + lambda)),
  ylab = colnames(b)[-1],
  ask = FALSE,
  show = rep(TRUE, NCOL(b) - 1),
  ...
)

\method{predict}{mixedsimex}(object, newdata, ...)
}
\arguments{
\item{model}{The naive model}

\item{SIMEXvariable}{Character vector specifying the names of variables with measurement error or misclassification}

\item{error.type}{Character vector indicating the type of error for each SIMEXvariable ("me" for measurement error, "mc" for misclassification)}

\item{measurement.error}{Measurement error variance-covariance matrix for variables with additive error}

\item{mc.matrix}{Misclassification probability matrix or list of matrices for variables with misclassification}

\item{lambda}{Vector of lambda values for the extrapolation step. Default is c(0.5, 1, 1.5, 2)}

\item{B}{Number of simulations for each lambda. Default is 100}

\item{fitting.method}{Method used for fitting the extrapolation. Default is "quadratic"}

\item{jackknife.estimation}{Specifying the extrapolation method for jackknife variance estimation. Can be set to FALSE if it should not be performed}

\item{asymptotic}{Logical, indicating if asymptotic variance estimation should be done}

\item{x}{Object of class 'mixedsimex'}

\item{digits}{Number of digits to be printed}

\item{\dots}{Additional arguments passed to other functions}

\item{object}{Object of class 'mixedsimex'}

\item{xlab}{Optional name for the X-Axis}

\item{ylab}{Vector containing the names for the Y-Axis}

\item{ask}{Logical. If TRUE, the user is asked for input, before a new figure is drawn}

\item{show}{Vector of logicals indicating for which variables a plot should be produced}

\item{newdata}{Optionally, a data frame in which to look for variables with which to predict}
}
\value{
An object of class "mixedsimex" containing the results of the SIMEX procedure.
\item{coefficients}{the corrected coefficients of the mixed SIMEX model,}
\item{SIMEX.estimates}{the estimates for every lambda,}
\item{model}{the naive model,}
\item{measurement.error}{the measurement error matrix,}
\item{mc.matrix}{the misclassification matrix,}
\item{B}{the number of iterations,}
\item{extrapolation}{the model object of the extrapolation step,}
\item{fitting.method}{the fitting method used in the extrapolation step,}
\item{residuals}{the residuals of the main model,}
\item{fitted.values}{the fitted values of the main model,}
\item{call}{the function call,}
\item{variance.jackknife}{the jackknife variance estimate,}
\item{extrapolation.variance}{the model object of the variance extrapolation,}
\item{variance.jackknife.lambda}{the data set for the extrapolation,}
\item{variance.asymptotic}{the asymptotic variance estimates,}
\item{theta}{the estimates for every B and lambda,}
...
}
\description{
This function implements the SIMEX method for models with both additive measurement error
and misclassification. It handles situations where one variable is misclassified and
another variable has additive measurement error.
}
\section{Methods (by generic)}{
\itemize{
\item \code{print(mixedsimex)}: Print method for mixedsimex objects

\item \code{summary(mixedsimex)}: Summary method for mixedsimex objects

\item \code{plot(mixedsimex)}: Plot method for mixedsimex objects

\item \code{predict(mixedsimex)}: Predict method for mixedsimex objects

}}
\section{Functions}{
\itemize{
\item \code{print(summary.mixedsimex)}: Print method for summary.mixedsimex objects

}}
\examples{
\dontrun{
# Example with both measurement error and misclassification
# Generate data
set.seed(123)
n <- 200
x_true <- rnorm(n)
z_true <- rbinom(n, 1, 0.5)
y <- 1 + 2*x_true - 1.5*z_true + rnorm(n, 0, 0.5)

# Add measurement error to x
me.var <- 0.5
x_obs <- x_true + rnorm(n, 0, sqrt(me.var))

# Add misclassification to z
mc.matrix <- matrix(c(0.9, 0.1, 0.2, 0.8), nrow = 2)
z_obs <- z_true
for(i in 1:n) {
  if(z_true[i] == 0) {
    z_obs[i] <- sample(c(0,1), 1, prob = c(mc.matrix[1,1], mc.matrix[1,2]))
  } else {
    z_obs[i] <- sample(c(0,1), 1, prob = c(mc.matrix[2,1], mc.matrix[2,2]))
  }
}

# Create data frame
data <- data.frame(y = y, x_obs = x_obs, z_obs = factor(z_obs))

# Fit naive model
naive_model <- lm(y ~ x_obs + z_obs, data = data, x = TRUE)

# Apply mixed SIMEX
result <- mixedsimex(naive_model, 
                    SIMEXvariable = c("x_obs", "z_obs"),
                    error.type = c("me", "mc"),
                    measurement.error = me.var, 
                    mc.matrix = mc.matrix)
summary(result)
plot(result)
}
}
